{% load static %}
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block page_title %}Информационный портал{% endblock %}</title>
  <meta name="description" content="{% block meta_description %}{{ SITE_DESCRIPTION|default:'Информационный портал с аналитическими статьями и практическими советами' }}{% endblock %}">
  <meta name="keywords" content="{% block meta_keywords %}статьи, аналитика, технологии, образование{% endblock %}">
  <meta name="author" content="{% block meta_author %}Информационный портал{% endblock %}">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="{% block og_type %}website{% endblock %}">
  <meta property="og:url" content="{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}">
  <meta property="og:title" content="{% block og_title %}Информационный портал{% endblock %}">
  <meta property="og:description" content="{% block og_description %}{{ SITE_DESCRIPTION|default:'Информационный портал с аналитическими статьями и практическими советами' }}{% endblock %}">
  
  <meta property="og:image" content="{% block og_image %}{% block og_image_default %}{% endblock %}{% endblock %}">
  <meta property="og:site_name" content="{{ SITE_NAME|default:'Информационный портал' }}">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{% block twitter_title %}Информационный портал{% endblock %}">
  <meta name="twitter:description" content="{% block twitter_description %}{{ SITE_DESCRIPTION|default:'Информационный портал с аналитическими статьями и практическими советами' }}{% endblock %}">
  <meta name="twitter:image" content="{% block twitter_image %}{% endblock %}">
  
  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="{% url 'portal:article_feed' %}">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="{% static 'portal/css/style.css' %}">
  {% block extra_head %}{% endblock %}
</head>
<body>
  <header class="shadow-sm">
    <nav class="navbar navbar-expand-lg navbar-light bg-white py-3">
      <div class="container">
        <a class="navbar-brand fw-semibold" href="{% url 'portal:article_list' %}">Информационный портал</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Переключить навигацию">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="mainNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link{% if request.resolver_match.url_name == 'article_list' and not current_category %} active{% endif %}" href="{% url 'portal:article_list' %}">Все статьи</a>
            </li>
            {% for category in nav_categories %}
              <li class="nav-item">
                <a class="nav-link{% if current_category == category.slug %} active{% endif %}" href="{% url 'portal:article_list' %}?category={{ category.slug }}">{{ category.name }}</a>
              </li>
            {% endfor %}
          </ul>
          <form class="d-flex" method="get" action="{% url 'portal:search' %}">
            <input class="form-control me-2" type="search" name="q" placeholder="Поиск по материалам" value="{{ request.GET.q }}">
            <button class="btn btn-primary" type="submit">Поиск</button>
          </form>
        </div>
      </div>
    </nav>
    {% block hero %}{% endblock %}
  </header>

  <main class="flex-grow-1">
    <div class="container py-4">
      {% if messages %}
        <div class="mb-3">
          {% for message in messages %}
            <div class="alert alert-{{ message.tags|default:'info' }} shadow-sm" role="alert">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
      {% block content %}{% endblock %}
    </div>
  </main>

  <footer class="mt-auto pt-5 pb-4 bg-dark text-light">
    <div class="container">
      <div class="row gy-4">
        <div class="col-lg-4">
          <h5 class="text-uppercase">О портале</h5>
          <p class="mb-0">Мы рассказываем о технологиях, образовании и трендах, которые формируют будущее. Еженедельно публикуем аналитические обзоры, экспертные комментарии и практические руководства.</p>
        </div>
        <div class="col-lg-4">
          <h5 class="text-uppercase">Разделы</h5>
          <ul class="list-unstyled footer-links">
            {% for category in nav_categories %}
              <li><a href="{% url 'portal:article_list' %}?category={{ category.slug }}">{{ category.name }}</a></li>
            {% empty %}
              <li><span class="text-muted">Разделы появятся позже</span></li>
            {% endfor %}
          </ul>
        </div>
        <div class="col-lg-4">
          <h5 class="text-uppercase">Популярное</h5>
          <ul class="list-unstyled footer-links">
            {% for article in trending_articles %}
              <li><a href="{{ article.get_absolute_url }}">{{ article.title }}</a></li>
            {% empty %}
              <li><span class="text-muted">Материалы появятся позже</span></li>
            {% endfor %}
          </ul>
          <div class="mt-3">
            <a href="{% url 'portal:article_feed' %}" class="text-decoration-none text-white-50 small">RSS Feed</a>
          </div>
        </div>
      </div>
      <hr class="border-secondary my-4">
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-center gap-3">
        <span>© {% now 'Y' %} Информационный портал. Все права защищены.</span>
        <div class="d-flex gap-3">
          <a class="text-decoration-none text-white-50" href="mailto:editor@infportal.local">Связаться с редакцией</a>
          <a class="text-decoration-none text-white-50" href="#top">Наверх ↑</a>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>
